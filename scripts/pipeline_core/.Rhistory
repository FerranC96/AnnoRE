load("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/.RData")
View(hsapiens)
setwd("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core")
View(subset)
View(vep_tsv)
View(hsapiens)
View(hsapiens)
View(x)
View(hsapiens)
class(hsapiens)
class(subset)
subset$rsID
hsapiens_haploR <- read.delim("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/output/hsapiens_haploR.tsv")
View(hsapiens_haploR)
?read.delim
?read.table
?utils
View(hsapiens_haploR)
View(hsapiens_haploR)
View(main_haploR)
main_haploR <- hsapiens_haploR[hsapiens_haploR$is_query_snp == 1,]
View(main_haploR)
View(main_haploR)
View(main_haploR)
View(hsapiens_haploR)
View(main_haploR)
View(subset)
View(x)
View(hsapiens_haploR)
View(vep_output)
vep_output
?merge
?merge.data.frame
merge.data.frame(hsapiens, main_haploR)
row.names(hsapiens)
hsapiens$Existing_variation
hsapiens[hsapiens$Existing_variation[0]]
hsapiens[hsapiens$Existing_variation[1]]
hsapiens[hsapiens$Existing_variation]
hsapiens[hsapiens$Existing_variation,]
for i in main_haploR$rsID{}
for i in main_haploR$rsID{
print("Hit!")
}
main_haploR$rsID
for i in main_haploR$rsID{print("Hit")}
for (i in main_haploR$rsID){print("Hit")}
for (i in main_haploR$rsID)
{
print(main_haploR$rsID[i])}
for (i in main_haploR$rsID)
{
print(main_haploR$rsID[:i])}
for (i in main_haploR$rsID)
{
print(main_haploR$rsID[,:i])}
for (i in main_haploR$rsID)
{
print(main_haploR$rsID[i])}
main_haploR$rsID[1]
main_haploR$rsID[0]
main_haploR$rsID[3]
main_haploR$rsID[64]
main_haploR$rsID[65]
main_haploR$rsID[63]
hsapiens$Existing_variation[64]
hsapiens$Existing_variation[64][1]
row(hsapiens)
for (i in row(hsapiens)){print("Hi")}
count <- 0
for (i in row(hsapiens)){count <- count + 1 print(count)}
for (i in row(hsapiens)){count <- count + 1}{print(count)}
for (i in row(hsapiens)){count <- count + 1{print(count)}}
for (i in row(hsapiens)){count <- count + 1}
count
count <- 0
for (i in row(hsapiens)){count <- count + 1}
count
row(hsapiens)
nrow(hsapiens)
print(i)
for (i in nrow(main_haploR)){
print(main_haploR$rsID[i])
}
print(main_haploR$rsID[0])
print(main_haploR$rsID[1])
print(main_haploR$rsID[172])
for (i in nrow(main_haploR)){
if (main_haploR$rsID[i] == "rs1058399"){
print (i)
}
}
print (main_haploR$rsID[i])
i <- NULL
remove(i)
for (i in nrow(main_haploR)){
if (main_haploR$rsID[i] == "rs1058399"){
print (main_haploR$rsID[i])
}
}
x <- i
remove(count)
remove(i)
remove(x)
#CADDING RSIDS COLUMN TO MODIFIED VEP OUTPUT
#THIS WILL BE USED FOR THE MERGER
View(hsapiens_haploR)
View(main_haploR)
df1 = data.frame(CustomerId=c(1:10),
Hobby = c(rep("sing", 4), rep("pingpong", 3), rep("hiking", 3)),
Product=c(rep("Toaster",3),rep("Phone", 2), rep("Radio",3), rep("Stereo", 2)))
View(df1)
df2 = data.frame(CustomerId=c(2,4,6, 8, 10),State=c(rep("Alabama",2),rep("Ohio",1),   rep("Cal", 2)),
like=c("sing", 'hiking', "pingpong", 'hiking', "sing"))
View(df2)
df3 = merge(df1, df2, by.x=c("CustomerId", "Hobby"), by.y=c("CustomerId", "like"))
View(df3)
df3 = merge(df1, df2, by.x=c("CustomerId", "Hobby"), by.y=c("CustomerId", "like"))
library(dplyr)
df1$Id <- df1$CustomerId
View(df1)
df1$CustomerId <- NULL
View(df1)
df3 <- full_join(df1, df2, by=c("Id", "CustomerId"))
df3 <- full_join(df1, df2, by=c("Id"="CustomerId"))
View(df3)
#TO MERGE TABLES BY IDS!
main_haploR2 <- subset(main_haploR, select = c(rsID, Proteins, eQTL))
View(main_haploR2)
main_haploR2 <- subset(main_haploR, select = c(rsID, Proteins, eQTL, Promoter_histone_marks, Enhancer_histone_marks))
View(main_haploR2)
merged <- left_join(hsapiens, main_haploR2, by=c("Existing_variation"="rsID"))
View(merged)
merged <- left_join(hsapiens, main_haploR2, by=c("X.Uploaded_variation"="rsID"))
View(merged)
merged <- left_join(hsapiens, main_haploR2, by=c("Existing_variation"<="rsID"))
merged <- left_join(hsapiens, main_haploR2, by=c("Existing_variation"="rsID"))
#NOW I JUST NEED EXTRA COLUM WITH RSID IN HSAPIENS!
View(df3)
library("tidyr", lib.loc="~/anaconda3/envs/rstudio/lib/R/library")
?separate
library("stringr", lib.loc="~/anaconda3/envs/rstudio/lib/R/library")
?mutate
hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, "(rs.*?)\,"))
View(hsapiens)
hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, "rs\d+(?=\,)"))
hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\d+(?=\,)"))
hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\,)"))
hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\\,)"))
View(merged)
View(hsapiens)
hsapiens2 <- mutate(hsapiens$rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\\,)"))
hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\\,)"))
hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs/d+(?=/,)"))
hsapiens 2 <- hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs/d+(?=/,)"))
hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs/d+(?=/,)"))
View(hsapiens)
hsapiens %>%
dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\\,)"))
hsapiens2 <- hsapiens %>% dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\\,)"))
View(hsapiens2)
hsapiens2 <- hsapiens %>% dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\\,|$"))
hsapiens2 <- hsapiens %>% dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\\,|$)"))
View(hsapiens2)
View(hsapiens)
View(hsapiens_haploR)
View(main_haploR)
View(main_haploR2)
View(hsapiens2)
merged <- left_join(hsapiens2, main_haploR2, by=c("rsID"))
View(merged)
summary(merged)
View(main_haploR)
View(main_haploR2)
View(main_haploR)
main_haploR2 <- subset(main_haploR, select = c(rsID, chr, Proteins, eQTL, Promoter_histone_marks, Enhancer_histone_marks))
View(main_haploR2)
View(merged)
View(merged)
View(merged)
write.table(merged, file="./output/main_output.tsv", quote=FALSE, sep="\t")
setwd("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core")
write.table(merged, file="./output/main_output.tsv", quote=FALSE, sep="\t")
write.table(merged, file="./output/main_output.tsv", quote=FALSE, row.names = FALSE, sep="\t")
source('~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/merge_data.R')
save.image("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/output/freezer/OLD_WORKSPACE.RData")
source('~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/merge_data.R')
#FROM HERE ON, WIP
merged <- left_join(vep_output, main_haploR, by=c("rsID"))
View(merged)
source('~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/merge_data.R')
#Loading vep output: In .tsv format with --tab flag, skip to 58 to get only header and table
vep_output <- read.delim("./output/hsapiens.tsv", comment.char="", skip=58)
install.packages("XGR")
install.packages("dnet")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("supraHex")
savehistory("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/output/freezer/RHISTORY.Rhistory")
getwd()
ls()
View(merged)
snp_file <- read.table("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/output/snp_file.txt", quote="\"", comment.char="")
snp_file
library(XGR)
test_Enrich <- xEnricherSNPs(snp_file)
snp_INPUTVECTOR <- as.vector(snp_file[,1])
test_Enrich <- xEnricherSNPs(snp_INPUTVECTOR)
ls()
test_Enrich
class(test_Enrich)
snp_file <- read.table("../../example_input/OCD_GWAS_SIGNIFICANT_SNP_RSIDs_all.txt", quote="\"", comment.char="")
snp_INPUTVECTOR <- as.vector(snp_file[,1])
test_Enrich <- xEnricherSNPs(snp_INPUTVECTOR)
test_Enrich
test_Enrich$g
test_Enrich$data
test_Enrich$term_info
xEnrichViewer(test_Enrich)
xEnrichBarplot(test_Enrich)
graph <- xEnrichBarplot(test_Enrich)
graph
snp_INPUTVECTOR
test_Enrich <- xEnricherSNPs(snp_INPUTVECTOR, min.overlap=3)
xEnrichViewer(test_Enrich)
graph <- xEnrichBarplot(test_Enrich)
graph
test_Enrich
test_Enrich$g
test_Enrich$term_info
ls()
savehistory(file="TestingXGR")
quit()
View(graph)
graph
View(test_Enrich)
library("ggplot2", lib.loc="~/anaconda3/envs/rstudio/lib/R/library")
View(graph)
graph
View(snp_file)
View(test_Enrich)
test_Enrich$term_info
test_Enrich$annotation
test_Enrich$g
test_Enrich$overlap
library(XGR)
enrich_results <- xEnrichViewer(test_Enrich)
enrich_results
quit()
View(enrich_results)
View(test_Enrich)
test_Enrich$term_info
test_Enrich$annotation
test_Enrich$overlap
test_Enrich$fc
test_Enrich <- xEnricherSNPs(snp_INPUTVECTOR, min.overlap=3, verbose=T)
library(XGR)
test_Enrich <- xEnricherSNPs(snp_INPUTVECTOR, min.overlap=3, verbose=T)
test_Enrich <- xEnricherSNPs(snp_INPUTVECTOR, min.overlap=3, verbose=T, ontology="EF")
test_Enrich_hypergeo <- xEnricherSNPs(snp_INPUTVECTOR, min.overlap=3, verbose=T, test="hypergeo")
test_Enrich_hypergeo
test_Enrich
test_Enrich <- xEnricherSNPs(snp_INPUTVECTOR, min.overlap=2, verbose=T, size.range=c(3,2000))
test_Enrich
ls()
enrich_results <- xEnrichViewer(test_Enrich)
enrich_results
View(enrich_results)
View(xEnrichBarplot(test_Enrich))
xEnrichBarplot(test_Enrich)
bar_test <- xEnrichBarplot(test_Enrich)
bar_test
dag_test <- xEnrichDAGplot(test_Enrich)
dot_test <- xEnrichDotplot(test_Enrich)
dot_test
concis_test <- xEnrichConciser(test_Enrich)
concis_test
dag_test
xEnrichDAGplot(test_Enrich)
xEnrichDAGplotAdv(test_Enrich)
xEnrichDAGplotAdv(dag_test)
xEnrichDAGplotAdv(test_Enrich$g)
xEnrichDAGplotAdv(enrich_results)
quit()
View(bar_test)
bar_test
View(concis_test)
concis_test
dag_test
ggplot2(dag_test)
ggplot2::(dag_test)
library("ggplot2", lib.loc="~/anaconda3/envs/rstudio/lib/R/library")
ggplot(dag_test)
dag_test]
dag_test
View(dag_test)
library("Rgraphviz", lib.loc="~/anaconda3/envs/rstudio/lib/R/library")
dag_test
plot.dag_test
Rgraphviz::plot(dag_test)
View(dot_test)
dot_test
View(enrich_results)
View(graph)
graph
View(merged)
View(snp_file)
View(test_Enrich)
View(enrich_results)
test_Enrich$annotation
View(test_Enrich$annotation)
class(enrich_results)
View(enrich_results)
test_Enrich$data
test_Enrich$annotation
View(enrich_results)
test_Enrich$annotation$`EFO:0000719`
quit()
View(snp_file)
bar_test
View(enrich_results)
haploR_output <- read.delim("./output/OCD_haploR.tsv")
OCD_haploR <- read.delim("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/output/OCD_haploR.tsv")
View(OCD_haploR)
OCD_haploR <- read.delim("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/output/OCD_haploR.tsv", row.names=NULL)
View(OCD_haploR)
OCD <- read.delim("~/MSc/Project_3/MSc_Project3/scripts/pipeline_core/output/OCD.tsv", header=FALSE, comment.char="#")
View(OCD)
OCD <- read.delim("./output/OCD.tsv", comment.char="", skip=58)
View(OCD)
main_haploR <- haploR_output[haploR_output$is_query_snp == 1,]
main_haploR <- subset(main_haploR, select = c(rsID, chr, Proteins, eQTL, Promoter_histone_marks, Enhancer_histone_marks))
vep_output <- read.delim("./output/OCD.tsv", comment.char="", skip=58)
vep_output <- vep_output %>% dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\\,|$)"))
library(dplyr)
library(stringr)
vep_output <- vep_output %>% dplyr::mutate(rsID = str_extract(Existing_variation, pattern = "rs\\d+(?=\\,|$)"))
merged <- left_join(vep_output, main_haploR, by=c("rsID"))
View(merged)
write.table(merged, file="./output/OCD_main_output.tsv", quote=FALSE, row.names = FALSE, sep="\t")
